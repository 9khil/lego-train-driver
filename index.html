<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="initial-scale = 1.0, user-scalable = no, width = device-width"/>
	<title>LEGO Train Driver</title>
	<style>
		body {
			margin:0;
			text-align:center;
			color: #999;
			background:#3498db;
			font-size:76px;
			height:100%;
			overflow:hidden;
			-webkit-touch-callout: none;
			-webkit-user-select: none;
			-khtml-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
			user-select: none;
		}

		#drive {
			width:100%;
			height:400px;
			padding-top:180px;
			text-align:center;
			color:#fff;
			font-family: 'Ubuntu', sans-serif;
		}

		.driving {
			background:#2ecc71;
		}

		.stopped {
			background:#3498db;
		}
	</style>
	<link href='http://fonts.googleapis.com/css?family=Ubuntu:700' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script type="application/javascript">

		// if user is running mozilla then use it's built-in WebSocket
		window.WebSocket = window.WebSocket || window.MozWebSocket;

		var connection = new WebSocket('ws://10.0.1.143:1337');

		connection.onopen = function () {
			// connection is opened and ready to use
		}

		connection.onerror = function (error) {
			// an error occurred when sending/receiving data
		}

		connection.onmessage = function (message) {
			switch (message) {
				case "driving":
					$('body').removeClass('stopped').addClass('driving');
					break;
				case "stopped":
					$('body').removeClass('driving').addClass('stopped');
					break;
			}
		}

		$(document).ready(function() {

			$('#drive').on({'touchstart': function() {
				connection.send('drive');
			}});

			$('#drive').on({'touchend': function() {
				connection.send('stop');
			}});
		});

		document.body.addEventListener('touchmove', function(e){ e.preventDefault(); });
	</script>
</head>
<body>
<div id="drive">
	Hold to drive
</div>
</body>
</html>
